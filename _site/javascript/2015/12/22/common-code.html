<!DOCTYPE html>
<html lang="en">
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<link rel="stylesheet" href="/css/theme.css">
	<title>一些会经常用到的代码</title>
</head>
<body>
	<div class="site">
		<header class="clearfix" id="top">
			<nav class="top-menu">
	<ul class="unstyled list-inline">
		<li><a href="/index.html">Index</a></li>
		<li><a href="/article.html">Article</a></li>
		<li><a href="javascript:;">Project</a></li>
		<li><a href="javascript:;">GitHub</a></li>
	</ul>
</nav>
		</header>
		<div class="page-container clearfix">		
			<div class="page-content-wrapper">
				<div class="page-content">
					<div class="page-title">
						<h2 class="title">
							一些会经常用到的代码
						</h2>
						<p class="label">
							<span>tag: <i>javascript</i></span>
							<span>category: <i>javascript</i></span>
							<span>date: <i>22 Dec 2015</i></span>
						</p>
					</div>					
					<div class="article-info">
						<h2 class="page-header">loading <small>一个简单的loading</small></h2>
<pre class="code">
//js代码
var loading = function(){
    var count = 0;
    return function(status){
        var loadingHtml = '<div id="loading"><div class="loading-con"><div class="loading-circle"></div></div></div>';            
        if(window.top.$('#loading').length === 0){
            window.top.$('body').append(loadingHtml);
        }
        status ? count++ :count--;
        if(count < 1){
            count = 0;
            window.top.$('#loading').hide();
        }else{
            window.top.$('#loading').show();
        }
        return true;
    };
};
//css代码
@keyframes spin {
  0% {
    transform: rotate(0deg);
  }
  100% {
    transform: rotate(360deg);
  }
}
#loading {
  position: fixed;
  left: 0;
  right: 0;
  top: 0;
  bottom: 0;
  width: 100%;
  height: 100%;
  display: none;
  background: rgba(0, 0, 0, 0.5);
}
#loading .loading-con {
  position: absolute;
  left: 50%;
  top: 50%;
  margin-left: -30px;
  margin-top: -30px;
  width: 116px;
  height: 116px;
}
#loading .loading-con .loading-circle {
  width: 60px;
  height: 60px;
  border: 8px solid;
  border-color: #11994b #f2a808 #2399e7 #c0392b;
  border-radius: 50%;
  animation: spin 1s infinite linear;
}
</pre>
<h2 class="page-header">queryToObject <small>请求字符串转对象</small></h2>
<pre class="code">
function queryToObject(/*String*/str){
    var dec = decodeURIComponent,
        qp = str.split('&'),//query parameters
        ret = {}, // return
        name,
        val;
    qp.forEach(function(item){
        if(!item.length) return;
        var s = item.indexOf('=');
        if(s === -1){
            name = dec(item);
            val = '';
        }else{
            name = dec(item.slice(0,s));
            val = dec(item.slice(s + 1));
        }
        if(typeof ret[name] === 'string'){
            ret[name] = [ret[name]];
        }
        Array.isArray(ret[name]) ? ret[name].push(val) : (ret[name] = val);
    });
    return ret;
};
</pre>
<h2 class="page-header">hash <small>获取和设置hash</small></h2>
<pre class="code">
function(){
    var action = {
        set:function(){
            var hashObj = $.queryToObject($.hash());
            if(arguments.length === 1){
                var myObj = arguments[0];
                typeof myObj === 'object' && $.extend(hashObj,myObj);
            }else{
                hashObj[arguments[0]] = arguments[1];
            }
            $.hash(hashObj);
        },
        get:function(key){
            return $.queryToObject($.hash())[key];
        },
        remove:function(key){
            var hashObj = $.queryToObject($.hash());
            delete hashObj[key];
            $.hash(hashObj);
        }
    };
    switch(arguments.length){
        case 0:
            return window.location.hash.replace(/^[^#]*#?(.*)$/,'$1');
        case 1:
            var hash = arguments[0];
            if(typeof hash === 'string'){
                window.location.hash = (hash[0] === '#' ? '' : '#') + hash;
            }
            if(typeof hash === 'object'){
                window.location.hash = '#' + $.param(hash);
            }
        case 2:
            return action[arguments[0]](arguments[1]);
        case 3:
            return action[arguments[0]](arguments[1],arguments[2]);
    }
};
//获取：hash()  hash('get',key)
//设置：hash(obj|string)  hash(set,obj)  hash(set,key,value)
//与queryToObject同时使用
</pre>
<h2 class="page-header">selectText <small>全选文字</small></h2>
<pre class="code">
function selectText(el/*element*/){
    if (document.selection) {
        var range = document.body.createTextRange();
        range.moveToElementText(el);
        range.select();
    } else if (window.getSelection) {
        var range = document.createRange();
        range.selectNodeContents(el);
        window.getSelection().addRange(range);
    }
}
</pre>

<h2 class="page-header">insertText <small>在输入框中插入字符</small></h2>
<pre class="code">
function insertText(){
    var txtArea = this;
    //IE
    if (document.selection) {
        txtArea.focus();
        var sel = document.selection.createRange();
        sel.text = textValue;
        return;
    }
        //Firefox, chrome, mozilla
    else if (txtArea.selectionStart || txtArea.selectionStart == '0') {
        var startPos = txtArea.selectionStart;
        var endPos = txtArea.selectionEnd;
        var scrollTop = txtArea.scrollTop;
        txtArea.value = txtArea.value.substring(0, startPos) + textValue + txtArea.value.substring(endPos, txtArea.value.length);
        txtArea.focus();
        txtArea.selectionStart = startPos + textValue.length;
        txtArea.selectionEnd = startPos + textValue.length;
    }
    else {
        txtArea.value += textArea.value;
        txtArea.focus();
    }
}
</pre>
<h2 class="page-header">toFixed <small>格式化数字</small></h2>
<pre class="code">
function toFixed(value/*String|Number*/, preciseFigures/*Number*/, def/*String*/) {
    if (value === '') {
        return '';
    }
    if (value === null || value === undefined) {
        return def === undefined ? '--' : '';
    }
    value = Number(value);
    preciseFigures = /^\d?$/.test(preciseFigures) ? preciseFigures : 2;
    if (isNaN(value)) {
        return def === undefined ? '--' : '';
    }
    return value.toFixed(preciseFigures);
}
</pre>
	
					</div>					
				</div>
			</div>
			<div class="page-sidebar-wrapper">
	<div class="page-sidebar">
		<dl>
			<dt>Categories</dt>
			<dd>
				<ul class="unstyled">
					
					<li><a href="/category/index.html#cat=javascript">javascript <span class="badge">1</span></a></li>
					
					
				</ul>
			</dd>
			<dt>Tags</dt>
			<dd>
				<ul class="unstyled">
					
					<li>
						<a href="/tag/index.html#tag=javascript">javascript <span class="badge">1</span></a>
					</li>
													
				</ul>
			</dd>
		</dl>
	</div>
</div>
		</div>
	</div>
	<div class="clearfix"></div>
	<footer class="page-footer">
	<div>©  2013—2015 </div>
</footer>
	
	<script src="/js/plugins/jquery-1.11.3.min.js"></script>
	
	<link rel="stylesheet" href="/js/plugins/laycode/laycode.css">
	<script src="/js/plugins/laycode/laycode.js"></script>
	<script>
		$(function(){
			$('.code').each(function(){
				$(this).html($(this).html().replace(/"/g,'&#34;')
					   .replace(/'/g,'&#39;')
					   .replace(/</g,'&lt;')
					   .replace(/>/g,'&gt;'))
						.laycode();
			});
		});
	</script>
</body>
</html>
